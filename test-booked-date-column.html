<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booked Date Column Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .delivery-date { background-color: #e8f5e8; }
        .booked-date { background-color: #fff3cd; }
    </style>
</head>
<body>
    <h1>ðŸ“… Booked Date Column Test</h1>
    <p><strong>TESTING:</strong> New "Booked Date" column in Active Deliveries table</p>
    
    <div class="test-section">
        <h3>ðŸ“Š Table Structure Test</h3>
        <table>
            <thead>
                <tr>
                    <th>DR Number</th>
                    <th>Customer</th>
                    <th>Status</th>
                    <th class="delivery-date">Delivery Date</th>
                    <th class="booked-date">Booked Date</th>
                    <th>Item #</th>
                </tr>
            </thead>
            <tbody id="testTableBody">
                <!-- Test data will be populated here -->
            </tbody>
        </table>
    </div>
    
    <div class="test-section">
        <h3>ðŸŽ¯ Column Explanation</h3>
        <div class="delivery-date" style="padding: 10px; margin: 5px 0; border-radius: 5px;">
            <strong>ðŸ“… Delivery Date:</strong> The date the user selected for delivery (e.g., "Oct 31, 2025")
        </div>
        <div class="booked-date" style="padding: 10px; margin: 5px 0; border-radius: 5px;">
            <strong>ðŸ“… Booked Date:</strong> When the user actually booked the item (today's date + current time)
        </div>
    </div>
    
    <div class="test-section">
        <h3>ðŸ“Š Test Results</h3>
        <div id="results">
            <button onclick="testBookedDateFunction()">Test Booked Date Function</button>
            <div id="testOutput" style="margin-top: 10px;"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h3>ðŸŽ¯ Expected Results</h3>
        <ul>
            <li><strong>Delivery Date:</strong> User's selected date (e.g., "Jan 31, 2025")</li>
            <li><strong>Booked Date:</strong> Today's date + current time (e.g., "Oct 29, 2024, 2:30 PM")</li>
            <li><strong>Clear Separation:</strong> Two different dates for different purposes</li>
            <li><strong>No Confusion:</strong> User knows when they booked vs when it will be delivered</li>
        </ul>
    </div>

    <script>
        // Mock delivery data for testing
        const mockDeliveries = [
            {
                drNumber: 'DR-TEST-001',
                customerName: 'Test Customer 1',
                status: 'Active',
                deliveryDate: '2025-01-31', // User selected delivery date
                created_date: '2025-01-31'
            },
            {
                drNumber: 'DR-TEST-002', 
                customerName: 'Test Customer 2',
                status: 'Active',
                deliveryDate: '2025-02-15', // User selected delivery date
                created_date: '2025-02-15'
            }
        ];
        
        // Simulate the getBookedDate function
        function getBookedDate(delivery) {
            const now = new Date();
            const bookedDate = now.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
            const bookedTime = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            return `${bookedDate}, ${bookedTime}`;
        }
        
        // Simulate delivery date formatting (simple)
        function formatDeliveryDate(dateString) {
            if (!dateString) return 'No Date';
            
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            } catch (error) {
                return dateString;
            }
        }
        
        function populateTestTable() {
            const tableBody = document.getElementById('testTableBody');
            
            tableBody.innerHTML = mockDeliveries.map(delivery => {
                const deliveryDate = formatDeliveryDate(delivery.deliveryDate);
                const bookedDate = getBookedDate(delivery);
                
                return `
                    <tr>
                        <td><strong>${delivery.drNumber}</strong></td>
                        <td>${delivery.customerName}</td>
                        <td><span class="badge bg-success">${delivery.status}</span></td>
                        <td class="delivery-date"><strong>${deliveryDate}</strong></td>
                        <td class="booked-date"><strong>${bookedDate}</strong></td>
                        <td>ITM-001</td>
                    </tr>
                `;
            }).join('');
        }
        
        function testBookedDateFunction() {
            const output = document.getElementById('testOutput');
            output.innerHTML = '';
            
            console.log('ðŸ§ª Testing Booked Date Function...');
            
            const testDelivery = mockDeliveries[0];
            const bookedDate = getBookedDate(testDelivery);
            const deliveryDate = formatDeliveryDate(testDelivery.deliveryDate);
            
            output.innerHTML = `
                <div class="info"><strong>Test Results:</strong></div>
                <div>DR Number: ${testDelivery.drNumber}</div>
                <div class="delivery-date">Delivery Date: <strong>${deliveryDate}</strong> (User's selection)</div>
                <div class="booked-date">Booked Date: <strong>${bookedDate}</strong> (When user booked)</div>
                <br>
                <div class="success">âœ… PASS: Two separate date columns working correctly</div>
                <div class="info">ðŸ“… Delivery Date shows user's selected date</div>
                <div class="info">ðŸ“… Booked Date shows when user actually booked (today + time)</div>
            `;
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateTestTable();
            
            console.log('ðŸ“… Booked Date Column Test Loaded');
            console.log('ðŸŽ¯ Testing separation of Delivery Date vs Booked Date');
            
            // Auto-run test
            setTimeout(() => {
                testBookedDateFunction();
            }, 1000);
        });
    </script>
</body>
</html>