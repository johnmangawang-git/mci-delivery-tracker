<!DOCTYPE html>
<html>
<head>
    <title>Function Debug</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1>Function Debug</h1>
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Test Functions</h5>
                    </div>
                    <div class="card-body">
                        <button id="checkFunctions" class="btn btn-primary mb-2">Check Available Functions</button>
                        <button id="testCalendarInit" class="btn btn-primary mb-2">Test Calendar Init</button>
                        <button id="testCalendarUpdate" class="btn btn-primary mb-2">Test Calendar Update</button>
                        <button id="testBookingModal" class="btn btn-primary mb-2">Test Booking Modal</button>
                        <button id="checkElements" class="btn btn-secondary mb-2">Check Elements</button>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Output</h5>
                    </div>
                    <div class="card-body">
                        <div id="output" style="height: 400px; overflow-y: scroll; background-color: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px;">
                            <p>Debug output will appear here...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load the actual application scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/modal-utils.js"></script>
    <script src="assets/js/calendar.js"></script>
    <script src="assets/js/booking.js"></script>
    <script src="assets/js/main.js"></script>
    
    <script>
        // Simple logging function
        function log(message) {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            output.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            output.scrollTop = output.scrollHeight;
        }
        
        // Check available functions
        function checkFunctions() {
            log('=== CHECKING AVAILABLE FUNCTIONS ===');
            
            const importantFunctions = [
                'initCalendar',
                'updateCalendarFromCalendarJs',
                'openBookingModal',
                'initBookingModal',
                'showModal',
                'hideModal'
            ];
            
            importantFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    log(`✓ ${funcName} - AVAILABLE`);
                } else {
                    log(`✗ ${funcName} - NOT FOUND`);
                }
            });
            
            // List all functions
            const allFunctions = Object.keys(window).filter(key => typeof window[key] === 'function');
            log(`Total functions available: ${allFunctions.length}`);
        }
        
        // Test calendar initialization
        function testCalendarInit() {
            log('=== TESTING CALENDAR INITIALIZATION ===');
            
            if (typeof window.initCalendar === 'function') {
                try {
                    log('Calling initCalendar()');
                    window.initCalendar();
                    log('✓ initCalendar executed successfully');
                } catch (error) {
                    log(`✗ Error calling initCalendar: ${error.message}`);
                    console.error(error);
                }
            } else {
                log('✗ initCalendar function not found');
            }
        }
        
        // Test calendar update
        function testCalendarUpdate() {
            log('=== TESTING CALENDAR UPDATE ===');
            
            if (typeof window.updateCalendarFromCalendarJs === 'function') {
                try {
                    log('Calling updateCalendarFromCalendarJs()');
                    window.updateCalendarFromCalendarJs();
                    log('✓ updateCalendarFromCalendarJs executed successfully');
                } catch (error) {
                    log(`✗ Error calling updateCalendarFromCalendarJs: ${error.message}`);
                    console.error(error);
                }
            } else {
                log('✗ updateCalendarFromCalendarJs function not found');
            }
        }
        
        // Test booking modal
        function testBookingModal() {
            log('=== TESTING BOOKING MODAL ===');
            
            if (typeof window.openBookingModal === 'function') {
                try {
                    log('Calling openBookingModal("2023-10-24")');
                    window.openBookingModal('2023-10-24');
                    log('✓ openBookingModal executed successfully');
                } catch (error) {
                    log(`✗ Error calling openBookingModal: ${error.message}`);
                    console.error(error);
                }
            } else {
                log('✗ openBookingModal function not found');
            }
        }
        
        // Check elements
        function checkElements() {
            log('=== CHECKING ELEMENTS ===');
            
            const importantElements = [
                'bookingView',
                'calendarGrid',
                'bookingModal',
                'prevMonth',
                'nextMonth'
            ];
            
            importantElements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element) {
                    log(`✓ ${elementId} - FOUND`);
                } else {
                    log(`✗ ${elementId} - NOT FOUND`);
                }
            });
        }
        
        // Add event listeners when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            log('Debug tool loaded');
            
            document.getElementById('checkFunctions').addEventListener('click', checkFunctions);
            document.getElementById('testCalendarInit').addEventListener('click', testCalendarInit);
            document.getElementById('testCalendarUpdate').addEventListener('click', testCalendarUpdate);
            document.getElementById('testBookingModal').addEventListener('click', testBookingModal);
            document.getElementById('checkElements').addEventListener('click', checkElements);
        });
    </script>
</body>
</html>